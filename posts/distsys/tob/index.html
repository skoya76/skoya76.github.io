<!doctype html><html lang=jp><head><title>Total Order Broadcast</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="ie=edge"><link rel=stylesheet href=/application.5b7777e57c70f92a6339db87ad8b77d43266b3f01b9b591a1fac1f495003fb3c.css integrity="sha256-W3d35Xxw+SpjOduHrYt31DJms/Abm1kaH6wfSVAD+zw="><link rel=icon type=image/png href=/images/site/favicon_hub02d7508a1c89b2b7812eab204efeb9a_4223_42x0_resize_box_3.png><meta property="og:title" content="Total Order Broadcast"><meta property="og:description" content="本記事はdev.toから移植しました．
What is Total order? The way to determine if a given element is in total order is simple. That is, &ldquo;Can you put those elements in a row?&rdquo;.
For example, what if the natural numbers 7, 8, 1, 4, and 5 are given? We can then serialize 1<4<5<7<8. In other words, the natural numbers are total order.
What about the sets {b, d}, {d,d} {z, b} next? They cannot be serialized."><meta property="og:type" content="article"><meta property="og:url" content="https://hugo-toha.github.io/posts/distsys/tob/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-08-20T00:00:00+00:00"><meta property="article:modified_time" content="2022-08-20T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Total Order Broadcast"><meta name=twitter:description content="本記事はdev.toから移植しました．
What is Total order? The way to determine if a given element is in total order is simple. That is, &ldquo;Can you put those elements in a row?&rdquo;.
For example, what if the natural numbers 7, 8, 1, 4, and 5 are given? We can then serialize 1<4<5<7<8. In other words, the natural numbers are total order.
What about the sets {b, d}, {d,d} {z, b} next? They cannot be serialized."><meta name=description content="Total Order Broadcast"><script async src="https://www.googletagmanager.com/gtag/js?id=G-H4LBG7NDFZ"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-H4LBG7NDFZ",{anonymize_ip:!1})}</script></head><body class="type-posts kind-page" data-spy=scroll data-target=#TableOfContents data-offset=80><div class="container-fluid bg-dimmed wrapper"><nav class="navbar navbar-expand-xl top-navbar final-navbar shadow"><div class=container><button class="navbar-toggler navbar-light" id=sidebar-toggler type=button>
<span class=navbar-toggler-icon></span></button>
<a class=navbar-brand href=/><img src=/images/site/main-logo_hu9ad2f25a877e6fef77c7a3dbef5094ad_6881_42x0_resize_box_3.png alt=Logo>
Koya's Blog</a>
<button class="navbar-toggler navbar-light" id=toc-toggler type=button>
<span class=navbar-toggler-icon></span></button><div class="collapse navbar-collapse lang-selector" id=top-nav-items><ul class="navbar-nav ml-auto"><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=themeSelector role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false><img id=navbar-theme-icon-svg src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a><div id=themeMenu class="dropdown-menu dropdown-menu-icons-only" aria-labelledby=themeSelector><a class="dropdown-item nav-link" href=# data-scheme=light><img class=menu-icon-center src=/icons/sun-svgrepo-com.svg width=20 alt="Light Theme"></a>
<a class="dropdown-item nav-link" href=# data-scheme=dark><img class=menu-icon-center src=/icons/moon-svgrepo-com.svg width=20 alt="Dark Theme"></a>
<a class="dropdown-item nav-link" href=# data-scheme=system><img class=menu-icon-center src=/icons/computer-svgrepo-com.svg width=20 alt="System Theme"></a></div></li></ul></div></div><img src=/images/site/main-logo_hu9ad2f25a877e6fef77c7a3dbef5094ad_6881_42x0_resize_box_3.png class=d-none id=main-logo alt=Logo>
<img src=/images/site/inverted-logo_hub02d7508a1c89b2b7812eab204efeb9a_4223_42x0_resize_box_3.png class=d-none id=inverted-logo alt="Inverted Logo"></nav><section class=sidebar-section id=sidebar-section><div class=sidebar-holder><div class=sidebar id=sidebar><form class=mx-auto method=get action=/search><input type=text name=keyword placeholder=検索 data-search id=search-box></form><div class=sidebar-tree><ul class=tree id=tree><li id=list-heading><a href=/posts/ data-filter=all>記事</a></li><div class=subtree><li><a href=/posts/books/ title=Books>Books</a></li><li><i class="fas fa-minus-circle"></i><a class=active href=/posts/distsys/> Distributed Systems</a><ul class=active><li><a href=/posts/distsys/communicationmodels/ title="Communication Models">Communication Models</a></li><li><a href=/posts/distsys/failuremodels/ title="Failure Models">Failure Models</a></li><li><a href=/posts/distsys/timestamp/ title="Lamport Timestamp">Lamport Timestamp</a></li><li><a href=/posts/distsys/smr/ title="State Machine Replication">State Machine Replication</a></li><li><a class=active href=/posts/distsys/tob/ title="Total Order Broadcast">Total Order Broadcast</a></li><li><a href=/posts/distsys/consistencies/ title="Various Consistencies">Various Consistencies</a></li><li><a href=/posts/distsys/multipaxos/ title="What is the MultiPaxos?">What is the MultiPaxos?</a></li><li><a href=/posts/distsys/paxos/ title="What is the Paxos?">What is the Paxos?</a></li></ul></li><li><i class="fas fa-plus-circle"></i><a href=/posts/internship/> Internship</a><ul><li><a href=/posts/internship/kag/ title=KAG>KAG</a></li><li><a href=/posts/internship/rakuten/ title=Rakuten>Rakuten</a></li><li><a href=/posts/internship/toray/ title=Toray>Toray</a></li></ul></li></div></ul></div></div></div></section><section class=content-section id=content-section><div class=content><div class="container p-0 read-area"><div class="hero-area col-sm-12" id=hero-area style=background-image:url(/images/default-hero.jpg)></div><div class=page-content><div class="author-profile ml-auto align-self-lg-center"><img class=rounded-circle src=/images/author/koya_hub4903c7e348867ff40ef2ef6922c64b1_58020_120x120_fit_q75_box.jpeg alt="Author Image"><h5 class=author-name>塩崎 功也（シオザキ コウヤ）</h5><p>Saturday, August 20, 2022</p></div><div class=title><h1>Total Order Broadcast</h1></div><div class=taxonomy-terms><ul style=padding-left:0></ul></div><div class=post-content id=post-content><p>本記事は<a href=https://dev.to/skoya76/total-order-broadcast-5ccl target=_blank rel=noopener>dev.to</a>から移植しました．</p><h2 id=what-is-total-order>What is Total order?</h2><p>The way to determine if a given element is in total order is simple. That is, &ldquo;Can you put those elements in a row?&rdquo;.</p><p>For example, what if the natural numbers 7, 8, 1, 4, and 5 are given? We can then serialize 1&lt;4&lt;5&lt;7&lt;8. In other words, the natural numbers are total order.</p><p>What about the sets {b, d}, {d,d} {z, b} next? They cannot be serialized. In other words, these sets are not in total order.</p><p><a href=https://dev.to/skoya76/state-machine-replication-196n target=_blank rel=noopener>State machine replication</a> requires the total order of operations.</p><h2 id=how-to-total-order-operations>How to Total order operations?</h2><h3 id=1-logical-clock>1. Logical clock</h3><p>The idea behind the logical clock is simple. For each operation, a counter is incremented and its number is included in the operation information. Each replica applies operations in the ascending order of that counter.</p><p>For example, suppose that the operations are issued in the order op_A, op_B, and op_C. Then cnt (op_A) = 0, cnt (op_B) = 1, and cnt (op_C) = 2 are given. The replica applies the operations according to that number in the order op_A, op_B, and op_C.</p><p>This can be accomplished by installing a leader replica. All operations are communicated to the leader. This allows the leader to assign a counter number to the operation. All replicas can then apply the operations according to that number to guarantee total order.</p><p>There are situations, however, in which it is not desirable to implement a single leader. How can we ensure total order then?</p><h3 id=2-lamport-timestamphttpsdevtoskoya76lamport-timestamp-4fhb>2. <a href=https://dev.to/skoya76/lamport-timestamp-4fhb target=_blank rel=noopener>Lamport timestamp</a></h3><p>This is explained in detail in another article by me. As explained in this article, the total order guaranteed by the Lamport timestamp may not be sufficient. For example, suppose that operations are issued to create identical usernames on different nodes. However, the usernames must be unique. In this case, one might think that the one with the smaller timestamp (the write created first) should win. But is that instantly possible? We don&rsquo;t know if there is another account with the same username being created in parallel on another node, whose timestamp may or may not be larger than the timestamp we are trying to win. In other words, the full order of operations will only be determined after we have information on all the nodes.</p><p>Therefore, to implement the unique constraint, the total order of operations is not sufficient, and the total order broadcast described below is needed to know the definite time of the total order.</p><h2 id=total-order-broadcast>Total order broadcast</h2><p>There are two safety concerns that total order broadcasts must satisfy.</p><ol><li>Messages are not lost.</li><li>Messages received by any node are always received by all nodes.</li><li>Messages must be conveyed to all nodes in the same order.</li></ol><p>Different order is not allowed as shown in the following figure.
<img src=https://dev-to-uploads.s3.amazonaws.com/uploads/articles/kb3fmzi2h2704woav1nm.png alt=reverse></p><p>The following image shows an example of a successful total order broad.
<img src=https://dev-to-uploads.s3.amazonaws.com/uploads/articles/dqidaa5rivcj5beeldrl.png alt="in perfect order"></p><h3 id=what-makes-it-difficult>What makes it difficult?</h3><p>At first glance, a total order broadcast seems simple. However, it becomes difficult when using an asynchronous communication model. See <a href=https://dev.to/skoya76/communication-models-of-distributed-systems-26i2 target=_blank rel=noopener>my article</a> on various communication models for distributed systems.</p><p>The asynchronous communication model has the following characteristics</p><ol><li>Messages are eventually delivered.</li><li>Messages can be delayed with no upper limit.</li><li>Message arrival order not guaranteed.</li></ol><p>In other words, using the asynchronous communication model causes the problems shown in the following figure.</p><p><img src=https://dev-to-uploads.s3.amazonaws.com/uploads/articles/wmcfe2t1gw1i7f4rvpta.png alt=Deley></p><p>In other words, the order of arrival of messages may change if nothing is done under a delay environment. This does not adhere to the principle of total order broadcast.</p><h3 id=solution>Solution</h3><p>The solution is simple. First, the replica that wants to deliver a message broadcasts that message. In addition, the replica that receives the message broadcasts an &ldquo;ack&rdquo;. If all replicas agree, the message can be logged locally. This is illustrated in the following figure. The order relationship between m1 and m2 is m1 &lt; m2.</p><p><img src=https://dev-to-uploads.s3.amazonaws.com/uploads/articles/redosqvpe7b9h6v54h2u.png alt="total order"></p><p>The wait in the figure above indicates that it is waiting for m1 to agree. This is because if m2 is logged before m1, the order relationship is broken.</p><h2 id=comment>Comment</h2><p>This article introduced a simple all-order broadcast. However, frequent broadcasts are undesirable from the standpoint of communication volume. Therefore, new protocols with reduced communication costs, such as FastPaxos, have been developed.</p><p>Thank you for reading to the end!</p></div><div class="row pl-3 pr-3"><div class="col-md-6 share-buttons"><strong>Share on:</strong>
<a class="btn btn-sm facebook-btn" href="https://www.facebook.com/sharer.php?u=https%3a%2f%2fhugo-toha.github.io%2fposts%2fdistsys%2ftob%2f" target=_blank><i class="fab fa-facebook"></i></a>
<a class="btn btn-sm twitter-btn" href="https://twitter.com/share?url=https%3a%2f%2fhugo-toha.github.io%2fposts%2fdistsys%2ftob%2f&text=Total%20Order%20Broadcast&via=Koya%27s%20Blog" target=_blank><i class="fab fa-twitter"></i></a>
<a class="btn btn-sm reddit-btn" href="https://reddit.com/submit?url=https%3a%2f%2fhugo-toha.github.io%2fposts%2fdistsys%2ftob%2f&title=Total%20Order%20Broadcast" target=_blank><i class="fab fa-reddit"></i></a>
<a class="btn btn-sm linkedin-btn" href="https://www.linkedin.com/shareArticle?url=https%3a%2f%2fhugo-toha.github.io%2fposts%2fdistsys%2ftob%2f&title=Total%20Order%20Broadcast" target=_blank><i class="fab fa-linkedin"></i></a>
<a class="btn btn-sm whatsapp-btn" href="https://api.whatsapp.com/send?text=Total%20Order%20Broadcast https%3a%2f%2fhugo-toha.github.io%2fposts%2fdistsys%2ftob%2f" target=_blank><i class="fab fa-whatsapp"></i></a>
<a class="btn btn-sm email-btn" href="mailto:?subject=Total%20Order%20Broadcast&body=https%3a%2f%2fhugo-toha.github.io%2fposts%2fdistsys%2ftob%2f" target=_blank><i class="fas fa-envelope-open-text"></i></a></div><div class="col-md-6 btn-improve-page"><a href=https://github.com/hugo-toha/hugo-toha.github.io/edit/main/content/posts/distsys/tob/index.jp.md title=編集リクエストを送る target=_blank rel=noopener><i class="fas fa-code-branch"></i>
編集リクエストを送る</a></div></div><hr><div class="row next-prev-navigator"><div class="col-md-6 previous-article"><a href=/posts/distsys/smr/ title="State Machine Replication" class="btn btn-outline-info"><div><i class="fas fa-chevron-circle-left"></i> 前</div><div class=next-prev-text>State Machine Replication</div></a></div><div class="col-md-6 next-article"><a href=/posts/distsys/consistencies/ title="Various Consistencies" class="btn btn-outline-info"><div>次 <i class="fas fa-chevron-circle-right"></i></div><div class=next-prev-text>Various Consistencies</div></a></div></div><hr></div></div></div><a id=scroll-to-top class=btn><i class="fas fa-chevron-circle-up"></i></a></section><section class=toc-section id=toc-section><div class=toc-holder><h5 class="text-center pl-3">目次</h5><hr><div class=toc><nav id=TableOfContents><ul><li><a href=#what-is-total-order>What is Total order?</a></li><li><a href=#how-to-total-order-operations>How to Total order operations?</a><ul><li><a href=#1-logical-clock>1. Logical clock</a></li><li><a href=#2-lamport-timestamphttpsdevtoskoya76lamport-timestamp-4fhb>2. <a href=https://dev.to/skoya76/lamport-timestamp-4fhb>Lamport timestamp</a></a></li></ul></li><li><a href=#total-order-broadcast>Total order broadcast</a><ul><li><a href=#what-makes-it-difficult>What makes it difficult?</a></li><li><a href=#solution>Solution</a></li></ul></li><li><a href=#comment>Comment</a></li></ul></nav></div></div></section></div><footer id=footer class="container-fluid text-center align-content-center footer pb-2"><div class="container pt-5"><div class="row text-left"><div class="col-md-4 col-sm-12"><h5>メニュー</h5><ul><li class=nav-item><a class=smooth-scroll href=https://hugo-toha.github.io#about>About</a></li><li class=nav-item><a class=smooth-scroll href=https://hugo-toha.github.io#skills>Skills</a></li><li class=nav-item><a class=smooth-scroll href=https://hugo-toha.github.io#experiences>Experiences</a></li><li class=nav-item><a class=smooth-scroll href=https://hugo-toha.github.io#education>Education</a></li><li class=nav-item><a class=smooth-scroll href=https://hugo-toha.github.io#projects>Projects</a></li><li class=nav-item><a class=smooth-scroll href=https://hugo-toha.github.io#publications>Research Activities</a></li><li class=nav-item><a class=smooth-scroll href=https://hugo-toha.github.io#recent-posts>Recent-Posts</a></li></ul></div><div class="col-md-4 col-sm-12"><h5>連絡先</h5><ul><li><a href=mailto:koya@dsl.cs.tut.ac.jp target=_blank rel=noopener><span><i class="fas fa-envelope"></i></span> <span>koya@dsl.cs.tut.ac.jp</span></a></li><li><a href=https://github.com/skoya76 target=_blank rel=noopener><span><i class="fab fa-github"></i></span> <span>skoya76</span></a></li><li><span><i class="fas fa-phone-alt"></i></span> <span>+819092233048</span></li></ul></div><div class="col-md-4 col-sm-12"><p>メールで最新情報を受け取る</p><form action="https://github.us1.list-manage.com/subscribe/post?u=19de52a4603135aae97163fd8&amp;amp;id=094a24c76e" method=post id=mc-embedded-subscribe-form name=mc-embedded-subscribe-form class=validate target=_blank novalidate><div class=form-group><input type=email class=form-control id=mce-EMAIL name=EMAIL aria-describedby=emailHelp placeholder=ここにメールアドレスを入力>
<small id=emailHelp class="form-text text-muted">メールアドレスを入力すると、このウェブサイトのニュースレターを受け取ることに同意したことになります。</small></div><button type=submit class="btn btn-info">登録</button></form></div></div></div><hr><div class=container><p id=disclaimer><strong>責任通知:</strong> このテーマはMITライセンスのもとにあります。したがって、非営利、営利、プライベートの利用のためにそれを使用することができます。 テーマの著者からの許可を要求することなく、テーマを変更したり配布したりすることができます。 しかし、テーマの著者はテーマに関連する問題のための保証を提供せず、責任も負いません。</p></div><hr><div class=container><div class="row text-left"><div class=col-md-4><a id=theme href=https://github.com/hugo-toha/toha target=_blank rel=noopener><img src=/images/theme-logo_hu8376fd15465fef26ffe66b6bcf0ca686_13669_32x0_resize_box_3.png alt="Toha Theme Logo">
Toha</a></div><div class="col-md-4 text-center">© 2020 著作権.</div><div class="col-md-4 text-right"><a id=hugo href=https://gohugo.io/ target=_blank rel=noopener>搭載
<img src=/images/hugo-logo.svg alt="Hugo Logo" height=18></a></div></div></div></footer><script src=/application.64e24e192d5098ab92ea6c93b55507a4b1c0df101883339be49c828b7a929ff4.js integrity="sha256-ZOJOGS1QmKuS6myTtVUHpLHA3xAYgzOb5JyCi3qSn/Q=" defer></script></body></html>